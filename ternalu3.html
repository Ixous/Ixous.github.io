<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Import Katex -->
    <link rel="stylesheet" href="katex/katex.min.css">
    <script src="katex/katex.min.js"></script>
    <!-- Import Katex auto-render -->
    <script src="katex/contrib/auto-render.min.js"></script>

    <meta charset="UTF-8">
    <link rel="stylesheet" href="articles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <title>Ternary ALU</title>
    <style>
        .gate {
            width: 60px;
        }
    </style>
</head>
<body>
    <div id="content">
        <a id="indexlink" href="index.html" style="margin-bottom: 30px">
            Go back to the list of projects
        </a>
        <img class="banner_img" src="ternalu3.jpg" alt="">
        <div id="page_title">
            Working ternary ALU
        </div>
        <div id="page_date">
            02/12/2019
        </div>

        <p class="series-header">
            This article is part of my series of projects around Ternary Computing and Processor Design. <a href="index-ternary.html">Click here to see the list of projects of this series.</a>
        </p>


        <div id="page_title">
            CMOS Implementation and Analysis of Ternary Arithmetic Logic Unit
        </div>
        <div id="page_date">
            Louis <span style="font-variant: small-caps;">Duret-Robert</span>, Graduate Student in Electrical and Computer Engineering at Gerogia Institue of Technology
        </div>

        <p class="text">
            <strong><em>Abstract</em> – Ternary logic is an alternative to binary logic used in every modern processor. As a base-3 numerical system can represent numbers using fewer digits than in base 2, ternary logic circuits are theorized to be more compact than equivalent binary circuits. This increase in density could lead to a gain in performance measured in transistor cost, maximal frequency and energy consumption. In this project, the details of balanced ternary algebra are reviewed and a ternary Arithmetic Logic Unit (ALU) is designed and built using CMOS chips to prove the feasibility of large ternary CMOS circuits. Finally, a theoretical analysis of the benefits of balanced ternary logic is presented. The conservative conclusion of this analysis is that balanced ternary can be cheaper and faster than equivalent basic binary logic, however, binary logic has decades of optimization tricks making it way cheaper and faster.</strong>
        </p>
        <p class="text">
            <strong><em>Keywords</em> – ternary computing, processor architecture, ALU design, many-valued logic</strong>
        </p>


        <h2>Introduction</h2>


        <h3>Motivation</h3>

        <p class="text">
            Every modern computer uses binary logic, 1s and 0s, for computations. Theoretically, any numerical base can be used for computation [1]. The numerical base (or radix) defines how many digits will be necessary to represent a certain number, this is the radix economy and is written as $$E(b,N)$$ for base $$b$$ and number $$N$$ and calculated with the following formula.
            ££ E(b,N) = b \lfloor 1+log_b N \rfloor££
        </p>
        <p class="text">
            The lowest average radix economy is reached for base $$e \approx 2.72$$ [2]. The closest integer base is 3, not 2 ; ternary not binary, and leads on average to the smallest radix economy.
        </p>
        <p class="text">
            Therefore, a computer using ternary logic could be more efficient by requiring less digits and less circuitry for a similarly powerful processor. The most famous ternary computer was the <em>Setun</em> made by the soviets in the 1970s and was more efficient [3]. However, binary processors are easier to develop and binary won. As Moore's law slows down, it might be time to bring ternary computing back to gain performance.
        </p>
        <p class="text">
            Switching to ternary logic requires redefining a whole new algebra, and a more complex one as the number of possible states and thus gates is larger.
        </p>


        <h2>Ternary algebra</h2>


        <h3>Ternary values</h3>

        <p class="text">
            As the binary set of values is written $$\mathbb{B}=\{0,1\}$$, the symbol $$\mathbb{T}$$ will be used for the set of ternary values. There exist multiple ternary sets of values and thus multiple algebras : perhaps the most obvious is unbalanced ternary with $$\mathbb{T}=\{0,1,2\}$$ ; unknown-state ternary with $$\mathbb{T}=\{F,?,T\}$$ similar to an epistemological set of truth values and an extension of the Boolean True-False interpretation of binary logic ; and balanced ternary $$\mathbb{T}=\{-,0,+\}$$ [4].
        </p>
        <p class="text">
            Balanced ternary logic will be used in this report. It allows operations on negative and positive numbers by default with-out having to use the ternary equivalent of two’s complement. Consequently, if we only use the positive numbers, the range of possible values is halved. This choice benefits unsigned operations over signed operations.
        </p>
        <p class="text">
            In practice on an electrical computer, balanced ternary would be represented by positive, negative and zero voltage. Exotic ternary computers could use micro-fluid direction or light polarization. The use of ternary logic for quantum computation will not be discussed in this report.
        </p>
        <p class="text">
            Analogous to the binary 8-bit byte and 4-bit nibble, a 3-trit word can be called a tribble and a 9-trit word a tryte. The word tryte has also been used for a smaller 6-trit word, but does not follow powers of 3. A byte is two nibbles. A tryte is three tribbles.
        </p>

        <h3>One-input gates</h3>

        <p class="text">
            In binary, a gate with one input and one output can be represented as a two by one matrix.
        </p>
        <table>
            <tr>
                <th>Input</th>
                <th>Output</th>
            </tr>
            <tr>
                <th>0</th>
                <th>1</th>
            </tr>
            <tr>
                <th>1</th>
                <th>0</th>
            </tr>
        </table>
        <p class="text">
            Can be written with the matrix
            ££
            \begin{bmatrix}
            1\\
            0
            \end{bmatrix}
            ££
        </p>
        <p class="text">
            Therefore there are $$2^2=4$$ possible one-input one-output matrices in binary :
        </p>
        <table>
            <tr>
                <th>Matrix</th>
                <th>Schematic</th>
                <th>Description</th>
                <th>Name</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    0\\
                    0
                    \end{bmatrix}
                    $$
                </th>
                <th></th>
                <th>Clear</th>
                <th>CLR</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    1\\
                    1
                    \end{bmatrix}
                    $$
                </th>
                <th></th>
                <th>Mark</th>
                <th>MRK</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    0\\
                    1
                    \end{bmatrix}
                    $$
                </th>
                <th></th>
                <th>Identity, buffer or pass</th>
                <th>BUF</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    1\\
                    0
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/BI_NOT.png" class="gate dark_invert"></th>
                <th>Inverter</th>
                <th>NOT</th>
            </tr>
        </table>
        <div class="center_block">
            <p class="caption">
                Table 1 : binary one-input gates
            </p>
        </div>
        <p class="text">
            Only the last two are useful.
        </p>
        <p class="text">
            In ternary logic, one-input one-output gates can be represented with a three by one matrix. There are $$3^3=27$$ possible such gates. Here are the meaningful ones [5].
        </p>
        <table>
            <tr>
                <th>Matrix</th>
                <th>Schematic</th>
                <th>Description</th>
                <th>Name</th>
                <th>Symbol</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    -\\
                    0\\
                    +
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/BUF.png" class="gate dark_invert"></th>
                <th>Identity, buffer or pass</th>
                <th>BUF</th>
                <th>$$A$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    +\\
                    0\\
                    -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/NOT.png" class="gate dark_invert"></th>
                <th>Inverter</th>
                <th>NOT</th>
                <th>$$\overline A$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    +\\
                    +\\
                    -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/PNOT.png" class="gate dark_invert"></th>
                <th>Positively biased inverter</th>
                <th>PNOT</th>
                <th>$$\hat{A}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    +\\
                    -\\
                    -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/NNOT.png" class="gate dark_invert"></th>
                <th>Negatively biased inverter</th>
                <th>NNOT</th>
                <th>$$\check{A}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    +\\
                    0\\
                    +
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/ABS.png" class="gate dark_invert"></th>
                <th>Absolute value</th>
                <th>ABS</th>
                <th>$$|A|$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    0\\
                    0\\
                    +
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/CLU.png" class="gate dark_invert"></th>
                <th>Clamp up</th>
                <th>CLU</th>
                <th>$$\left \lceil{A}\right \rceil$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    -\\
                    0\\
                    0
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/CLD.png" class="gate dark_invert"></th>
                <th>Clamp down</th>
                <th>CLD</th>
                <th>$$\left \lfloor{A}\right \rfloor$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    0\\
                    +\\
                    +
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/INC.png" class="gate dark_invert"></th>
                <th>Increment</th>
                <th>INC</th>
                <th>$$A^{+}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    -\\
                    -\\
                    0
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/DEC.png" class="gate dark_invert"></th>
                <th>Decrement</th>
                <th>DEC</th>
                <th>$$A^{-}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    0\\
                    +\\
                    -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/RTU.png" class="gate dark_invert"></th>
                <th>Rotate up</th>
                <th>RTU</th>
                <th>$$A$$<sup>╯</sup></th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    +\\
                    -\\
                    0
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/RTD.png" class="gate dark_invert"></th>
                <th>Rotate down</th>
                <th>RTD</th>
                <th>$$A$$<sup><sup>╮</sup></sup></th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    -\\
                    -\\
                    +
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/ISP.png" class="gate dark_invert"></th>
                <th>Is positive</th>
                <th>ISP</th>
                <th>$$A^{=+}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    -\\
                    +\\
                    -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/ISZ.png" class="gate dark_invert"></th>
                <th>Is zero</th>
                <th>ISZ</th>
                <th>$$A^{=0}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    +\\
                    -\\
                    -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/ISN.png" class="gate dark_invert"></th>
                <th>Is negative</th>
                <th>ISN</th>
                <th>$$A^{=-}$$</th>
            </tr>
        </table>
        <div class="center_block">
            <p class="caption">
                Table 2 : ternary one-input gates
            </p>
        </div>
        <p class="text">
            Most of them are only useful in rare situations when building a processor. We can also note that ISZ is the same gate as NNOT. The ones to remember are the buffer and the three inverter gates.
        </p>

        <h3>Two-inputs gates</h3>

        <p class="text">
            As with one-input gates, two-inputs gates can also be represented with a matrix. For a simple binary OR gate :
        </p>
        <table>
            <tr>
                <th></th>
                <th>A</th>
                <th></th>
                <th></th>
            </tr>
            <tr>
                <th>B</th>
                <th></th>
                <th>0</th>
                <th>1</th>
            </tr>
            <tr>
                <th></th>
                <th>0</th>
                <th>0</th>
                <th>1</th>
            </tr>
            <tr>
                <th></th>
                <th>1</th>
                <th>1</th>
                <th>1</th>
            </tr>
        </table>
        <p class="text">
            Can be represented with the matrix
            ££
            \begin{bmatrix}
            0 & 1\\
            1 & 1
            \end{bmatrix}
            ££
        </p>
        <p class="text">
            There are $$2^{2^2}=16$$ possible binary two-inputs gates. The three useful ones with their inverted versions are :
        </p>
        <table>
            <tr>
                <th>Matrix</th>
                <th>Schematic</th>
                <th>Description</th>
                <th>Name</th>
                <th>Symbol</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    0 & 0\\
                    0 & 1
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/BI_AND.png" class="gate dark_invert"></th>
                <th>And</th>
                <th>AND</th>
                <th>$$A \times B$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    1 & 1\\
                    1 & 0
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/BI_NAND.png" class="gate dark_invert"></th>
                <th>Inverted and</th>
                <th>NAND</th>
                <th>$$\overline {A \times B}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    0 & 1\\
                    1 & 1
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/BI_OR.png" class="gate dark_invert"></th>
                <th>Or</th>
                <th>OR</th>
                <th>$$A + B$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    1 & 0\\
                    0 & 0
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/BI_NOR.png" class="gate dark_invert"></th>
                <th>Inverted or</th>
                <th>NOR</th>
                <th>$$\overline {A + B}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    0 & 1\\
                    1 & 0
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/BI_XOR.png" class="gate dark_invert"></th>
                <th>Exclusive or</th>
                <th>XOR</th>
                <th>$$A \oplus B$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    1 & 0\\
                    0 & 1
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/BI_XNOR.png" class="gate dark_invert"></th>
                <th>Inverted exclusive or</th>
                <th>XNOR</th>
                <th>$$\overline {A \oplus B}$$</th>
            </tr>
        </table>
        <div class="center_block">
            <p class="caption">
                Table 3 : useful binary two-inputs gates
            </p>
        </div>
        <p class="text">
            In ternary logic, two-inputs gates are represented with a three by three matrix. Thus there are $$3^{3^3}=19683$$ possible such gates. Only six useful gates and their inverted versions will be de-scribed, however some other gates can be useful such as some asymmetrical gates (as in switching the inputs produces differ-ent results and the matrix is asymmetrical).
        </p>
        <table>
            <tr>
                <th>Matrix</th>
                <th>Schematic</th>
                <th>Description</th>
                <th>Name</th>
                <th>Symbol</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    - & - & - \\
                    - & 0 & 0\\
                    - & 0 & +
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/AND.png" class="gate dark_invert"></th>
                <th>And / minimum</th>
                <th>AND</th>
                <th>$$A \times B$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    + & + & + \\
                    + & 0 & 0\\
                    + & 0 & -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/NAND.png" class="gate dark_invert"></th>
                <th>Inverted and / minimum</th>
                <th>AND</th>
                <th>$$\overline {A \times B}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    - & 0 & + \\
                    0 & 0 & +\\
                    + & + & +
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/OR.png" class="gate dark_invert"></th>
                <th>Or / maximum</th>
                <th>OR</th>
                <th>$$A + B$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    + & 0 & - \\
                    0 & 0 & -\\
                    - & - & -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/NOR.png" class="gate dark_invert"></th>
                <th>Inverted or / maximum</th>
                <th>NOR</th>
                <th>$$\overline {A + B}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    - & 0 & 0 \\
                    0 & 0 & 0\\
                    0 & 0 & +
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/CONS.png" class="gate dark_invert"></th>
                <th>Consensus</th>
                <th>CONS</th>
                <th>$$A ⊠ B$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    + & 0 & 0 \\
                    0 & 0 & 0\\
                    0 & 0 & -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/NCONS.png" class="gate dark_invert"></th>
                <th>Inverted consensus</th>
                <th>NCONS</th>
                <th>$$\overline {A ⊠ B}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    - & - & 0 \\
                    - & 0 & +\\
                    0 & + & +
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/ANY.png" class="gate dark_invert"></th>
                <th>Any</th>
                <th>ANY</th>
                <th>$$A ⊞ B$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    + & + & 0 \\
                    + & 0 & -\\
                    0 & - & -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/NANY.png" class="gate dark_invert"></th>
                <th>Inverted any</th>
                <th>NANY</th>
                <th>$$\overline {A ⊞ B}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    + & 0 & - \\
                    0 & 0 & 0\\
                    - & 0 & +
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/MUL.png" class="gate dark_invert"></th>
                <th>Multiplication</th>
                <th>MUL</th>
                <th>$$A \otimes B$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    - & 0 & + \\
                    0 & 0 & 0\\
                    + & 0 & -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/NMUL.png" class="gate dark_invert"></th>
                <th>Inverted multiplication</th>
                <th>NMUL</th>
                <th>$$\overline {A \otimes B}$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    + & - & 0 \\
                    - & 0 & +\\
                    0 & + & -
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/SUM.png" class="gate dark_invert"></th>
                <th>Addition</th>
                <th>SUM</th>
                <th>$$A \oplus B$$</th>
            </tr>
            <tr>
                <th>
                    $$
                    \begin{bmatrix}
                    - & + & 0 \\
                    + & 0 & -\\
                    0 & - & +
                    \end{bmatrix}
                    $$
                </th>
                <th><img src="ternlogic/NSUM.png" class="gate dark_invert"></th>
                <th>Inverted addition</th>
                <th>NSUM</th>
                <th>$$\overline {A \oplus B}$$</th>
            </tr>
        </table>
        <div class="center_block">
            <p class="caption">
                Table 4 : useful ternary two-inputs gates
            </p>
        </div>
        <p class="text">
            AND and OR ternary gates are sometimes called MIN and MAX for obvious reasons. The MUL gate is also sometimes called XOR.
        </p>
        <p class="text">
            The gate symbols used here are similar to the US binary gate symbols with modifications for the more complex operations. In addition, as with the US symbols, a dot on the output signifies an inverted output. The small triangle indicates that it's a ternary gate, to differentiate between equivalent binary and ternary gates. The symbols are based on the binary AND and OR gates : if we only look at the 2×2 submatrix for zero and positive inputs of the ternary gates, some look like binary AND and other like binary OR, so this is the base used for their symbols, then alterations are added.
        </p>

        <h3>Formulae</h3>

        <p class="text">
            Some gates are easy to implement with few transistors and resistors, while others require combining other simpler gates. This increases the cost but also the transmission time of the signal through the gate and thus the length of the transient before reaching the static phase with the correct output of the circuit. This can be a bottleneck for the frequency of a logic circuit such as a processor. Therefore, finding the best implementation of a gate is critical.
        </p>
        <p class="text">
            To find the formulas of logic gates from simple ones, I Python script is used to test every possible combinations of basic logic gates with simple operation prototypes. For instance, every combination with the pattern $$A \bigstar B$$ with $$\bigstar$$ a two-inputs gate. The script searches all the combinations for the simplest solutions with the smallest transistor and resistor cost.
        </p>
        <p class="text">
            As will be explained when looking at the CMOS implementation of those gates, the simple one-input gates are BUF, NOT, NNOT, PNOT as well as CLU and CLD if we allow the use of diodes. The simple two-inputs gates are NAND, NOR, NCONS and NANY.
        </p>
        <p class="text">
            As with binary algebra, many formulae help implementing the more complex gates. Some of the formulae are only useful be-cause they correspond to the CMOS implementations covered later.
        </p>
        <table>
            <tr>
                <td>$$\overline{\overline{A}}=A$$</td>
                <td>$$|A| = \overline { \overline{A} \times A}$$</td>
            </tr>
            <tr>
                <td>$$A^{=-}=\check{A}$$</td>
                <td>$$\left \lceil{A}\right \rceil = A + (0)$$</td>
            </tr>
            <tr>
                <td>$$A^{=+}=\overline{\hat{A}}$$</td>
                <td>$$\left \lfloor{A}\right \rfloor = A \times (0)$$</td>
            </tr>
            <tr>
                <td>$$A$$<sup>╯<sup>╯</sup></sup>$$=A$$<sup><sup>╮</sup></sup></td>
                <td>$$\overline{A \times B}=\overline{A} + \overline{B}$$</td>
            </tr>
            <tr>
                <td>$$A$$<sup><sup>╮<sup>╮</sup></sup></sup>$$=A$$<sup>╯</sup></td>
                <td>$$\overline{A + B}=\overline{A} \times \overline{B}$$</td>
            </tr>
            <tr>
                <td>$$A^+ = A⊞(+)$$</td>
                <td>$$\overline{A⊠B}=\overline{A}⊠\overline{B}$$</td>
            </tr>
            <tr>
                <td>$$A^- = A⊞(-)$$</td>
                <td>$$\overline{A⊞B}=\overline{A}⊞\overline{B}$$</td>
            </tr>
            <tr>
                <td>$$A$$<sup>╯</sup>$$ = A \oplus (+)$$</td>
                <td>$$A \otimes B=\overline{A} \otimes \overline{B}$$</td>
            </tr>
            <tr>
                <td>$$A$$<sup><sup>╮</sup></sup>$$ = A \oplus (-)$$</td>
                <td>$$\overline{A \oplus B}=\overline{A} \oplus \overline{B}$$</td>
            </tr>
        </table>
        <table>
            <tr>
                <td>
                    $$\overline{A \otimes B}=\overline{A} \otimes B=A \otimes \overline{B}$$
                </td>
            </tr>
            <tr>
                <td>
                    $$A$$<sup>╯<sup><sup>╮</sup></sup></sup> $$=A$$<sup><sup>╮╯</sup></sup>$$=A$$<sup><sup>╮<sup>╮<sup>╮</sup></sup></sup></sup>$$=A$$<sup>╯<sup>╯<sup>╯</sup></sup></sup>$$=A$$
                </td>
            </tr>
            <tr>
                <td>
                    $$A \otimes B = (A + \overline{B}) \times (\overline{A} + B) $$
                </td>
            </tr>
            <tr>
                <td>
                    $$A \otimes B = \overline{ \overline{A \times B} \times A + B } $$
                </td>
            </tr>
            <tr>
                <td>
                    $$\overline{A \otimes B} = \overline{ \overline{A + B} + A \times B } $$
                </td>
            </tr>
            <tr>
                <td>
                    $$A \oplus B = \left( A⊞B ⊞ \overline {A⊠B} \right) ⊞ \overline {A⊠B}$$
                </td>
            </tr>
            <tr>
                <td>
                    $$A \oplus B = \overline{ \overline{ A⊞B ⊞ \overline {A⊠B} } ⊞ A⊠B }$$
                </td>
            </tr>
            <tr>
                <td>
                    $$(A \times B) ⊠ (A+B) = A⊠B$$
                </td>
            </tr>
        </table>


        <h2>Basic CMOS implementations</h2>


        <h3>CMOS chip selection</h3>

        <p class="text">
            In order to assess the feasibility of ternary processors, implementations of the basic ternary logic gates will be first be described. Current processors use Complementary Metal Oxide Semiconductor (CMOS) logic with both PMOS and MNOS. Without access to expensive micro-fabrication, CMOS circuits will be built using the CD4007 chip. This chip contains three CMOS pairs but only one is usable as they are not independent. This chip comes in a DIP14 package, very useful for tests on breadboard and for custom PCB with DIP sockets to change the chip if it breaks down.
        </p>

        <p class="text">
            This chip works with voltages up to 15V so an adjustable dual-rail power supply is used to test different configurations.
        </p>

        <h2>Fundamental gates</h2>

        <p class="text">
            The ternary inverter actually comes in three versions, the neutral NOT and the positive and negatively biased NNOT and PNOT, but they don't require more circuitry : just a single CMOS pair. The other basic gates have two inputs, thus two CMOS pairs. For the two-input gates, the two corresponding transistors of the two CMOS pairs can either be setup in parallel or in series. Two configurations for the NMOS and the PMOS, so four configurations in total for the two pairs. Those are the four basic gates : NAND, NOR, NCONS, NANY [6] [7].
        </p>

        <p class="text">
            Note that the non-inverted two-inputs gates requires an additional regular inverter on the output of the simpler inverted versions.
        </p>

        <div class="center_block">
            <img class="image_tiny dark_invert" src="ternaryalu/NOTs_diode.png" alt="">
            <img class="image_tiny dark_invert" src="ternaryalu/NAND_diode.png" alt="">
            <img class="image_tiny dark_invert" src="ternaryalu/NOR_diode.png" alt="">
            <br>
            <img class="image_tiny dark_invert" src="ternaryalu/NCONS_diode.png" alt="">
            <img class="image_tiny dark_invert" src="ternaryalu/NANY_diode.png" alt="">
            <p class="caption">
                Figure 1 : Zener-CMOS implementation of ternary inverters, ternary NAND, ternary NOR, ternary NCONS and ternary NANY
            </p>
        </div>

        <p class="text">
            The CD4007 CMOS pair has a small negative voltage bias so the power supply is set to $$-5V$$ $$+5.7V$$. Two $$1kΩ$$ resistors are used between the PMOS and NMOS to stabilize the output. Additionally, a voltage shifter using a small $$2.2V$$ Zener diode and a $$100kΩ$$ pull-down resistor to ground are used to create a flat and neutral zero state. Without the voltage shifter, the neutral state corresponding to a 0 is on a slope, making it unstable when using the output to drive another gate, as can be seen on figure 2.
        </p>

        <div class="center_block">
            <img class="image_small dark_invert" src="ternaryalu/CMOS characteristics.svg" alt="">
            <p class="caption">
                Figure 2 : CMOS ternary inverter input/output characteristics
            </p>
        </div>

        <h3>Multiplication gate</h3>

        <p class="text">
            The more complex multiplication gate requires the combination of the fundamental gates described above, following the formula listed previously.
        </p>

        <div class="center_block">
            $$A \otimes B = \overline{ \overline{A \times B} \times A + B } $$
        </div>

        <div class="center_block">
            <img class="image_small dark_invert" src="ternaryalu/ternlogic_mul.png" alt="">
            <p class="caption">
                Figure 3 : multiplication gate equivalent circuit
            </p>
        </div>

        <p class="text">
            This equivalent circuit uses 7 CMOS pairs when implementing each gate separately. Some transistors can be factorized to reduce the cost of this gate ; however, this requires transistor-level control of the circuit which is not possible using the CD4007 chip. Therefore, this will not be explored in this paper.
        </p>

        <p class="text">
            The inverted multiplication gate can be built using the same number of transistors, which can be useful in certain circuits.
        </p>

        <h3>Addition gate</h3>

        <p class="text">
            The addition gate is a critical component for ALU circuits so a working cheap implementation is a major issue. As with the multiplication gate, the sum gate can be implemented using the fundamental gates.
        </p>

        <div class="center_block">
            $$A \oplus B = \left( A⊞B ⊞ \overline {A⊠B} \right) ⊞ \overline {A⊠B}$$
        </div>

        <div class="center_block">
            <img class="image_normal dark_invert" src="ternaryalu/ternlogic_sum.png" alt="">
            <p class="caption">
                Figure 4 : sum gate equivalent circuit
            </p>
        </div>

        <p class="text">
            This equivalent circuit uses 11 CMOS pairs. However, the inverted version of the sum gate is cheaper as it uses one less inverter, thus one less CMOS pair. Again, some transistors can be factorized to reduce the cost of this gate.
        </p>


        <h2>Ternary ALU design</h2>


        <h3>Basic design</h3>

        <p class="text">
            The main operation of the Arithmetic Logic Unit is the addition. This operation, as in any numerical base requires a carry system, a way to propagate the carry from the addition from one digit to the next. For the sake of simplicity, a ripple-carry system will be used in this design and not a carry-lookahead. That means adding the two trits of one digit of the words requires the carry of the previous pair of digits, therefore we have to wait for the previous sum to be completed. Consequently, as the word length increases, so does the time required for the operation to complete in a linear way. In a full processor, this reduces the maximum frequency, or requires complex timing and scheduling.
        </p>

        <p class="text">
            As with binary, we start by creating a half-adder, which add two trits and outputs the sum as well as the carry of this operation. The matrices of the sum and carry of two trits are given in figure 5. We recognize the sum of A and B to be the SUM gate and the carry is the CONS gate.
        </p>

        <div class="center_block">
            $$
            \begin{bmatrix}
            + & - & 0 \\
            - & 0 & +\\
            0 & + & -
            \end{bmatrix}
            \begin{bmatrix}
            - & 0 & 0 \\
            0 & 0 & 0\\
            0 & 0 & +
            \end{bmatrix}
            $$
            <p class="caption">
                <br>
                Figure 5 : sum of two trits (left) and carry of two trits (right)
            </p>
        </div>

        <p class="text">
            Thus, a ternary half-adder can easily be built.
        </p>

        <div class="center_block">
            <img class="image_two dark_invert" src="ternaryalu/ternaludesign_half.png" alt="">
            <p class="caption">
                Figure 6 : ternary half-adder
            </p>
        </div>

        <p class="text">
            Then two half-adders are combined to create a full-adder to add two trits as well as the previous carry. The carries of the two additions also have to be combined with an ANY gate.
        </p>

        <div class="center_block">
            <img class="image_normal dark_invert" src="ternaryalu/ternaludesign_full.png" alt="">
            <p class="caption">
                Figure 7 : ternary full-adder
            </p>
        </div>

        <p class="text">
            This is the heart of the ALU. The first and last additions of the chain of digits are special as they respectively don’t have a previous carry and don’t have to output a carry. Therefore, the first digit only requires one half-adder, and the last one requires two SUM gates.
        </p>

        <div class="center_block">
            <img class="image_smaller dark_invert" src="ternaryalu/ternaludesign_chain.png" alt="">
            <p class="caption">
                Figure 8 : ternary ALU chain
            </p>
        </div>

        <p class="text">
            Some ALU also include a flag signal for the overflow (when the operation results in a number outside the range of the architecture). It can be achieved by replacing the circuitry of the last digit with a usual full-adder. This of course increases the cost.
        </p>

        <h3>Subtraction</h3>

        <p class="text">
            As explained earlier, balanced ternary logic allows easy operations using positive and negative numbers. To negate a ternary number, the only process is to inverter every trit. This, an ALU that does only addition can do subtraction by negating one of the inputs.
        </p>

        <div class="center_block">
            <img class="image_smaller dark_invert" src="ternaryalu/ternaludesign_alu.png" alt="">
            <p class="caption">
                Figure 9 : ALU with negating circuit
            </p>
        </div>

        <p class="text">
            A simple circuit to negate a ternary word uses multiplication gates. Each trit of the word is fed in a multiplication gate and a common signal is used to control the sign of the output word.
        </p>

        <div class="center_block">
            <img class="image_smaller dark_invert" src="ternaryalu/ternaludesign_neg.png" alt="">
            <p class="caption">
                Figure 10 : negating circuit
            </p>
        </div>

        <h3>Optimization</h3>

        <p class="text">
            The number of CMOS pairs used for the ALU circuit can be reduced. Only the addition circuit will be considered here.
        </p>

        <p class="text">
            First, the fundamental gate of the ALU is the SUM gate. The SUM gate costs 11 CMOS pairs. Then to build a half-adder, a SUM gate and a CONS gate are needed for a total of 14 CMOS pairs. Then the full-adder requires two half-adders and an ANY gate, 31 CMOS pairs. The first digit of the ALU is a single half adder (because there is no incoming carry trit), 14 CMOS pairs, and the last digits is two SUM gates (no output carry trit, even though it is often the case that the last carry bit in a binary ALU is stored in a flag for branching instructions and the ability to do calculations with multiple words), 22 CMOS pairs ; the rest are full-adders. For a n-trit ALU ($$n≥2$$), the total cost of the ALU (not including the sign controller required for subtraction) is $$31n-26$$ CMOS pairs. For a 3-trit ALU, that amounts to 67 CMOS pairs.
        </p>

        <p class="text">
            We can spare one CONS gate per half-adder by using the NCONS gate in the SUM gate and adding a NOT gate. That saves 2 CMOS pairs per half-adder. The new total cost is $$27n-20$$ CMOS pairs, 61 CMOS pairs for a 3-trit ALU.
        </p>

        <div class="center_block">
            <img class="image_normal dark_invert" src="ternaryalu/ternalu2_nsumncons.png" alt="">
            <p class="caption">
                Figure 11 : ternary full-adder
            </p>
        </div>

        <p class="text">
            Another economy comes from the formulae listed previously. If we invert both inputs of a SUM gate, the output is unchanged.
        </p>

        <div class="center_block">
            $$A⊠B=\overline{A}⊠\overline{B}$$
            <br>
            $$A⊞B=\overline{A}⊞\overline{B}$$
            <br>
            $$A \otimes B=\overline{A} \otimes \overline{B}$$
            <br>
            $$A \oplus B=\overline{A} \oplus \overline{B}$$
        </div>

        <p class="text">
            The trick is to use inverted gates before the input, and since those inverted gates are usually cheaper, we can save transistors. This is simpler to understand with diagrams.
        </p>

        <div class="center_block">
            <img class="image_small dark_invert" src="ternaryalu/ternalu2_nhalf.png" alt="">
            <p class="caption">
                Figure 12 : N-half-adder
            </p>
        </div>

        <p class="text">
            Here is an alternative half-adder. Two symbols are used and here is why. The circle on the output still means that the out-put is inverted compared to the default gate (here the half-adder). The round cup on the input is supposed to indicate an inverter should be present on the input ; that is, to get the behaviour of the default gate, we have to invert this input. Here, the two symbols, taken with the labels, are the same : to get the behaviour of the default half-adder, we can either invert both output or both inputs. This is a direct consequence of the formulae listed above.
        </p>

        <p class="text">
            Using this N-half-adder, we can create a N-full-adder.
        </p>

        <div class="center_block">
            <img class="image_big dark_invert" src="ternaryalu/ternalu2_nfull.png" alt="">
            <p class="caption">
                Figure 13 : N-full-adder
            </p>
        </div>

        <p class="text">
            Again, both N-half-adders on this diagram correspond to the same internal circuitry described above. However, on the bottom one, we feed the original A and B signals, so we get the inverted sum and inverted carry of A and B. While on the top one, we feed in the inverted incoming carry and the inverted sum from the first N-half-adder, so we get the un-inverted final sum and the un-inverted carry. So, one carry is inverted and the other is not. To combine the two carries, we have to invert one and thus add a NOT gate. Then, to get the inverted total carry, a NANY is used, which is more expensive than the ANY gate.
        </p>

        <p class="text">
            Finally, the full ALU can be built again. As expected, the first and last digits are also different.
        </p>

        <div class="center_block">
            <img class="image_smaller dark_invert" src="ternaryalu/ternalu2_chain.png" alt="">
            <p class="caption">
                Figure 14 : new adder chain
            </p>
        </div>

        <p class="text">
            With those modifications, the N-half-adder costs 10 CMOS pairs, the N-full-adder 24 CMOS pairs, the first digit 11 CMOS pairs and the last digit 21 CMOS pairs. The total and final cost after optimization is $$24n-16$$ CMOS pairs, 56 for the 3-trit ALU.
        </p>

        <p class="text">
            Beside an economy of transistors, the optimizations also reduce the number of CMOS pairs the signal has to propagate through, and thus increases the maximum frequency of the processor. Calculating the critical path that will be explained later, a n-trit ternary ALU has a propagation delay of $$9n-7$$ CMOS propagation delays.
        </p>

        <p class="text">
            Further economy could be possible at the transistor level instead of pairs of transistors using the CD4007 chips as a reference.
        </p>



















        <p class="series-header">
            This article is part of my series of projects around Ternary Computing and Processor Design. <a href="index-ternary.html">Click here to see the list of projects of this series.</a>
        </p>

        <a id="indexlink" href="index.html" style="margin-top: 60px">
            Go back to the list of projects
        </a>
        <script>
            renderMathInElement(document.body,{delimiters: [
                {left: "$$", right: "$$", display: false},
                {left: "££", right: "££", display: true}
            ]});
        </script>
    </div>
</body>
</html>